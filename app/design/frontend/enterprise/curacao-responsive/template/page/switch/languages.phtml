<?php
/**
 * Magento Enterprise Edition
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Magento Enterprise Edition License
 * that is bundled with this package in the file LICENSE_EE.txt.
 * It is also available through the world-wide-web at this URL:
 * http://www.magentocommerce.com/license/enterprise-edition
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     enterprise_default
 * @copyright   Copyright (c) 2012 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://www.magentocommerce.com/license/enterprise-edition
 */
?>
<?php
/**
 * Language switcher template
 *
 * @see Mage_Page_Block_Switch
 */
?>

<?php 
	$_stores =  Mage::app()->getStores();	
	$_sessionID = Mage::getModel('core/session')->getSessionId();
?>

<?php if(count($_stores)>1): ?>
<div class="switch switcher-language">
    <label class="hidden"><?php echo $this->__('Language') ?>:</label>
    <div class="switch-wrapper" id="languageSelect">
    	<?php $i = 0; ?>
		<?php foreach($_stores as $_lang): ?>
		<?php 	if($_lang->getCode() == Mage::app()->getStore()->getCode()): ?>
		<strong class="current language-<?php echo $this->htmlEscape($_lang->getCode()) ?>">
            <img src="<?php echo $this->getSkinUrl('images/flag_' . $this->htmlEscape($_lang->getCode()) . '.png') ?>" width="16" height="11" alt="<?php echo $this->htmlEscape($_lang->getName()) ?>"/>
            <?php echo $this->htmlEscape(Mage::app()->getStore()->getName()) ?>
		</strong>
		<?php else: ?>
		<span class="language-<?php echo $this->htmlEscape($_lang->getCode()); ?>">
            <a href="<?php echo $_lang->getCurrentUrl().'&SID='.$_sessionID ?>" rel="<?php echo($_lang->getCode()) ?>">
	            <img src="<?php echo $this->getSkinUrl('images/flag_' . $this->htmlEscape($_lang->getCode()) . '.png') ?>" width="16" height="11" alt="<?php echo $this->htmlEscape($_lang->getName()) ?>"/>
    	        <?php echo $this->htmlEscape($_lang->getName()) ?>
			</a>
		</span>
		<?php	endif; ?>
		<?php if($i == 0) echo('<div class="lang-sep"></div>'); ?>
		<?php	$i++; ?>
		<?php endforeach; ?>        
<?php /*
		<form action="<?php echo($this->getURL()) ?>" method="GET" id="language-form">
			<input type="hidden" name="___language" id="lang">
		</form>
		
		<script type="text/javascript">
		//<![CDATA[
		    jQuery(document).ready(function() {        
		        jQuery('#languageSelect a').each(function(i,z){
					jQuery(this).click(function(){ 
						jQuery('#lang').val( jQuery(this).attr('rel'));
						jQuery('#language-form').submit();
						return false;
					});
		        });
		    });
		//]]>
		</script>
*/ ?>		
    </div>
</div>
<?php endif; ?>
