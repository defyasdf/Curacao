<?phpclass Ria_Pickup_Block_Pickup extends Mage_Core_Block_Template{	public function getStores()	{		$stores =  Mage::getSingleton('storepickup/store')->convertToList();		$this->setData('storecollection',$stores);		return $this->getData('storecollection');	}	public function loadStore($storeId)	{		$storeDetails =  Mage::getSingleton('storepickup/store')->load($storeId);		return $storeDetails;	}	public function loadstate($selectedStateID){		$states = Mage::getModel('directory/country')->load('US')->getRegions();		foreach ($states as $state){			if($state->getId() == $selectedStateID){				return $state->getName();			}		}		return '';	}	public function getMiles($storeId,$lat1, $lon1,$unit){		$storeDetails = $this->loadStore($storeId)->getData();		$storelatitude = $storeDetails['store_latitude'];		$storelongitude = $storeDetails['store_longitude'];		$theta = $lon1 - $storelongitude;		$dist = sin(deg2rad($lat1)) * sin(deg2rad($storelatitude)) +  cos(deg2rad($lat1)) * cos(deg2rad($storelatitude)) * cos(deg2rad($theta));		$dist = acos($dist);		$dist = rad2deg($dist);		$miles = $dist * 60 * 1.1515;		$unit = strtoupper($unit);		if ($unit == "K") {			return ($miles * 1.609344);		} else if ($unit == "N") {			return ($miles * 0.8684);		} else {			return $miles;		}	}	}